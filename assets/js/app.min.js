$(document).ready(function(){function u(){return $(".active")}function v(a){return a%1===0}function w(a){return v(a)?b[a]:b[u().index()]}function x(a,c){b[a]=c}function y(){w().focus()}function z(a){chrome.storage.local.set(a)}function A(a,b){chrome.storage.local.get(a,b)}function B(a){return a.attr("id").replace("tab","")}function C(a){return a.find(".material-icons")}function D(a){return a.find(".folder-name").first().text()}function E(a,b){a.find(".folder-name").first().text(b)}function F(a){return a.find(".file-name").text()}function G(a,b){a.find(".file-name").text(b)}function H(){return $(".CodeMirror")}function I(){return $(".sidebar")}function J(){return $(".workspace")}function K(){return $(".projects")}function L(){return $(".settings-container")}function M(){return $(".tabs")}function N(){return $(".new")}function O(){return $(".open")}function P(){return $(".open-dir")}function Q(){return $(".add-newproject")}function R(a){return v(a)?$(".tab").eq(a):$(".tab")}function S(){return $(".bg")}function T(){$(".preload").stop().velocity({opacity:"0"},{duration:800,complete:function(){$(this).hide()}}),$("body").removeClass("preload-body")}function U(a){var b=a.children().length;b=40*b+"px",a.is(":visible")?a.stop().animate({height:"0px"},200,function(){$(this).hide()}):a.show().stop().animate({height:b},200)}function V(){var d,e,a=H().css("font-family"),b=H().css("font-size"),c=$(".selector-library").clone().children().remove().end().text();d=!!$(".linter-checkbox").hasClass("active-checkbox"),e=!!$(".activeline-checkbox").hasClass("active-checkbox"),j={theme:t.theme,font:a,fontSize:b,tabSize:t.tabSize,softWrap:t.lineWrapping,library:c,lint:d,styleActiveLine:e},z({settings:j})}function W(){for(var a=0;a<b.length;a++)w(a).refresh()}function X(a,b){var c=a.split(","),d=b<0?0:255,e=b<0?b*-1:b,f=parseInt(c[0].slice(4)),g=parseInt(c[1]),h=parseInt(c[2]);return"rgb("+(Math.round((d-f)*e)+f)+","+(Math.round((d-g)*e)+g)+","+(Math.round((d-h)*e)+h)+")"}function Y(a){I().css("background-color",X(a,-.2)),$(".workspace, body").css("background-color",a),$(".windowBar").css("background-color",X(a,.1)),L().css("background-color",X(a,-.1))}function Z(a){t.theme=a.theme,t.tabSize=a.tabSize,t.indentUnit=a.tabSize,t.lineWrapping=a.softWrap,t.lint=a.lint,t.styleActiveLine=a.styleActiveLine}function _(a){H().css("font-family",a.font),H().css("font-size",a.fontSize),ja([{option:"theme",value:a.theme},{option:"tabSize",value:a.tabSize},{option:"lineWrapping",value:a.softWrap},{option:"lint",value:a.lint},{option:"styleActiveLine",value:a.styleActiveLine}]),u().attr("class","tab active active-"+a.theme),Y(ma()),Z(a),la(ma()),W()}function aa(a,b){$(a).html(b+'<div class="material-icons">arrow_drop_down</div>')}function ba(a){return a===!0?"wrap":"none"}function ca(a){return void 0===a?".jquery.min.js":a}function da(){$(".folder").removeClass("active-folder"),$(".file").removeClass("active-file")}function ea(a){a.hasClass("file")?(da(),a.addClass("active-file")):(da(),a.addClass("active-folder"))}function fa(a,b){a===!1?($(b).removeClass("active-checkbox"),C($(b)).text("")):($(b).addClass("active-checkbox"),C($(b)).text("check"))}function ga(a){aa(".selector-theme",a.theme.replace(/-/g," ")),aa(".selector-font",a.font.replace(/"/g,"").toLowerCase()),aa(".selector-font-size",a.fontSize),aa(".selector-tab-size",a.tabSize),aa(".selector-wrap",ba(a.softWrap)),aa(".selector-library",ca(a.library)),fa(a.styleActiveLine,".activeline-checkbox"),fa(a.lint,".linter-checkbox")}function ha(){A({settings:"prefs"},function(a){var b=a.settings;"prefs"==b||void 0===b||null===b?(Ob(),_(j),ga(j)):(j=b,_(b),ga(b))})}function ia(a,c){for(var d=0;d<b.length;d++)w(d).setOption(a,c)}function ja(a,b){var c,d;a&&a.forEach(function(b,e,f){c=a[e].option,d=a[e].value,ia(c,d)}),b&&(c=b.option,d=b.value,ia(c,d))}function ka(a,b){a.html(b+'<div class="material-icons">arrow_drop_down</div>')}function la(a){$(".tabs, .overflow-menu").css("background-color",a)}function ma(){return H().css("background-color")}function na(a,b){t[a]=b}function oa(a,b){c[a]=b}function pa(a){return c[a]}function qa(a,b,c){a.move(b,c)}function ra(a,b){a.splice(b,1)}function sa(a){return Qa?"string"==typeof a?a.replace(Qa.fullPath,""):a.fullPath.replace(Qa.fullPath,""):"string"==typeof a?a:a.fullPath}function ta(a,b){$.get(a,function(a){var c;c=nb?"keyboard_arrow_down"==C(nb).first().text()||"book"==C(nb).eq(1).text()?nb:nb.parent().parent():K().children().first();var d=D(c),e=c.attr("path"),f=bb(d,e,!1,!0);f.getFile(b,{create:!0,exclusive:!0},function(b){b.createWriter(function(b){var c=new Blob([a]);b.write(c)}),g.push({entry:b});var d=Ta(b.name),e=sa(b),f=document.createElement("div"),h=sb(b.name,!0);f.className=d+" file",f.setAttribute("path",e),f.innerHTML=h+'<label class="file-name">'+b.name+"</label>",c.children().last().append(f),ab(c.children().last().children().last()),V()})})}function ua(){$(".dropdown").hide(),L().show().stop().animate({top:"50%",opacity:"1"},200),S().show().stop().animate({opacity:"0.6"},200),$(".settingdiv span").hide()}function va(){L().stop().animate({top:"60%",opacity:"0"},200,function(){$(this).hide()}),S().stop().animate({opacity:"0"},200,function(){$(this).hide()})}function xa(a){w(a).on("change",function(){$(".active .close").text("fiber_manual_record"),$(".active .close").addClass("edit")});var b=w(a).defaultCharWidth(),c=4;w(a).on("renderLine",function(a,d,e){var f=CodeMirror.countColumn(d.text,null,a.getOption("tabSize"))*b;e.style.textIndent="-"+f+"px",e.style.paddingLeft=c+f+"px"})}function ya(){k=[];for(var a=0;a<R().length;a++){var b=B(R(a));k.push(Number(b))}}function za(){var a;0===R().length?a=0:(ya(),a=Math.max.apply(null,k)+1),R().removeClass("active"),R().removeClass("active-"+t.theme),M().append('<div id="tab'+a+'"class="tab active active-'+t.theme+'"><input class="title"/><span class="close material-icons">close</span></div>'),Ab("untitled.txt"),J().append('<textarea id="textarea'+a+'"></textarea>'),u().attr("id","tab"+a),H().hide(),Hb(),$("#textarea"+a).show(),Cb(""),oa(a,"")}function Aa(a){h.push({entry:a}),Wa(h.length-1),$a(a),y()}function Ba(){za();var a=u().index();x(a,CodeMirror.fromTextArea(document.getElementById("textarea"+a),t)),Ab("untitled.txt"),oa(a,""),setTimeout(function(){u().click(),xa(a)})}function Da(a){La();var b=$(".active .title").val();$(".dialogue .dialogue-text").text(b+" has been modified. Unless saved, progress will be lost. Save changes?"),$(".dialogue").show().stop().animate({top:"50%",opacity:"1"},200),S().show().stop().animate({opacity:"0.6"},200),m=a}function Ea(){$(".dialogue").stop().animate({top:"60%",opacity:"0"},200,function(){$(this).hide()}),S().stop().animate({opacity:"0"},200,function(){$(this).hide()})}function Ga(a,d){var e=a.parent(),f=e.attr("id"),g=f.replace("tab","textarea"),h=e.attr("class"),i=e.index(),k=M().children().last().index(),l=R().length;$("#"+g).remove(),$(".CodeMirror:eq("+e.index()+")").remove(),ra(b,i),ra(c,i),a.parent().remove(),void 0===j&&Ob(),d||(0===i&&1==l?(Ba(),_(j)):h.indexOf("active")==-1?u().click():0===i?R(0).click():i==k?R(i-1).click():R(i).click(),Hb(),Ea())}function Ha(){""===window.getSelection()?$(".search-bar").select():$(".search-bar").val(window.getSelection()),chrome.app.window.current().isFullscreen()?J().css("height","calc(100% - 150px)"):J().css("height","calc(100% - 180px)"),$(".search-container").show().stop().animate({opacity:"1",bottom:"0px"},200),setTimeout(function(){$(".search-bar").focus()},200)}function Ia(){J().css("height","calc(100% - 80px)"),$(".search-container").show().stop().animate({opacity:"0",bottom:"-100px"},200,function(){$(this).hide(),r=w(),clearSearch(r),y()})}function Ja(a){$(".search-bar").attr("searchNext",a)}function Ka(){var a=60*$(".menu").children().length+"px";$(".menu").show().stop().animate({opacity:"1",height:a},200)}function La(){$(".menu").stop().animate({opacity:"0",height:"0px"},200,function(){$(this).hide()})}function Ma(a){u().attr("path",a)}function Na(a,b){a.forEach(function(a){a.file(function(c){var d=new FileReader;d.onload=function(c){var d=c.target.result;za(),Ab(a.name);var e=sa(a);b===!1?(Ma(e),Cb(a.name)):(Cb(a.name+"isOpen"),Ma(e)),$(".active input").attr("readonly",!0);var f=B(u()),g=Number(f),h=u().index();oa(h,a),x(h,CodeMirror.fromTextArea(document.getElementById("textarea"+g),t)),w(h).getDoc().setValue(d),w(h).getDoc().clearHistory(),w(h).focus(),xa(h),Gb(),void 0===j&&Ob(),_(j)},d.readAsText(c)})})}function Oa(){$(".new-project-dialogue").show().stop().animate({top:"50%",opacity:"1"},200),S().show().stop().animate({opacity:"0.6"},200)}function Pa(){$(".new-project-dialogue").stop().animate({top:"60%",opacity:"0"},200,function(){$(this).hide()}),S().stop().animate({opacity:"0"},200,function(){$(this).hide()})}function Ra(a){a.fullPath?($(".chosenDir").text(a.fullPath),Qa=a):($(".chosenDir").text("No Directory Chosen"),Qa=null)}function Sa(){$(".projects div").each(function(){$(this).hasClass("file")&&$(this).insertAfter($(this).parent().children().last())})}function Ta(a){return a=btoa(unescape(encodeURIComponent(a))),a.replace(/\./g,"").replace(/ /g,"_").replace(/["'()]/g,"_").replace(/[^\w\s]/gi,"").replace(/[\W\s]/gi,"").replace(/0/g,"a").replace(/1/g,"b").replace(/2/g,"c").replace(/3/g,"d").replace(/4/g,"e").replace(/5/g,"f").replace(/6/g,"g").replace(/7/g,"h").replace(/9/g,"i")}function Ua(a,b,c){return a=a.split(b),0===c?a:a[a.length-c]}function Va(a){return 2==a.split("/").length}function Wa(a){var b=h[a].entry.name,c=h[a].entry.fullPath;c=sa(h[a].entry);var d=h[a].entry.fullPath;d=sa(h[a].entry),c=Ua(c,"/",0),c.forEach(function(a,b,d){c[b]=Ta(a)}),b=Ta(b);var f,e=document.createElement("div");e.className=b+" folder",e.setAttribute("path",d),f=Va(d)?'<div class="material-icons">book</div>':'<div class="material-icons">folder</div>',e.innerHTML='<div class="material-icons">keyboard_arrow_right</div>'+f+'<label class="folder-name">'+h[a].entry.name+'</label><ul style="display:none;" class="'+b+'ul"></ul>',c.shift(),c.forEach(function(a,b,d){c[b]=a+" > ."+a+"ul/"}),c="."+c.join(" > ."),c=c.split("/"),c.pop(),c.forEach(function(a,b,c){if(1==c.length)o.appendChild(e);else if(0===b);else{var d=c.slice(0),f=d.length-b;d.splice(b,f),d=d.join(" "),null===o.querySelector(d)||o.querySelector(d).appendChild(e)}})}function Xa(a){var b=g[a].entry.name,c=g[a].entry.fullPath;c=sa(g[a].entry);var d=g[a].entry.fullPath;d=sa(g[a].entry),c=Ua(c,"/",0),c.forEach(function(a,b,d){c[b]=Ta(a)}),b=Ta(b);var e=document.createElement("div"),f=sb(g[a].entry.name,!0);e.className=b+" file",e.setAttribute("path",d),e.innerHTML=f+'<label class="file-name">'+g[a].entry.name+"</label>",c.shift(),c.forEach(function(a,b,d){b===d.length-1?c[b]=a:c[b]=a+" > ."+a+"ul"}),c.pop(),c="."+c.join(" > ."),o.querySelector(c).appendChild(e)}function Ya(a,b,c){$(".loading-text").text("Loading "+a),$(".preload").css("top","100%"),$(".preload").show().stop().animate({top:"0",opacity:"1"},500),b&&b(c)}function Za(){$(".preload").stop().animate({opacity:"0",top:"100%"},600,function(){$(this).hide()})}function $a(a){var b=a.createReader(),c=function(){b.readEntries(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.isDirectory?(h.push({entry:c}),Wa(h.length-1),$a(c)):(g.push({entry:c}),Xa(g.length-1))}})};c()}function _a(a){o.innerHTML="",a.getMetadata(function(b){var c=b.size,d=Math.ceil(c);Number.isFinite(d)===!1&&(d=1e3),d>2e4&&(d=2e4),d<5e3&&(d=2500),Aa(a),setTimeout(function(){K().append(o.children),Sa(),Za()},d)})}function ab(a){var d,b=C(a).first(),c=a.parentsUntil(".projects").length;d=a.hasClass("file")?20*(c/2)+43+"px":20*(c/2)+20+"px",b.css("padding-left",d)}function bb(a,b,d,e,f,i){var j,k=function(c){var d=sa(c.entry);if(c.entry.name==a&&b==d)return c},l=function(c){var d=sa(c);if(c.name==a&&b==d)return c};return d&&(j=g.find(k)),e&&(j=h.find(k)),i&&(j=c.find(l)),f?j:j.entry}function db(a){var b=a.pageY,c=a.pageX,d=$(".contextmenu").height();b+d>$(window).height()&&(b-=d),$(".contextmenu").css({top:b-20+"px",left:c-20+"px"}).show().stop().animate({top:b+"px",opacity:"1"},200)}function eb(){$(".contextmenu").stop().animate({top:Number($(".contextmenu").css("top").replace("px",""))-20+"px",opacity:"0"},200,function(){$(this).hide()})}function fb(a){var b=a.pageY,c=a.pageX,d=$(".folder-contextmenu").height();b+d>$(window).height()&&(b-=d),$(".folder-contextmenu").css({top:b-20+"px",left:c-20+"px"}).show().stop().animate({top:b+"px",opacity:"1"},200)}function gb(){$(".folder-contextmenu").stop().animate({top:Number($(".folder-contextmenu").css("top").replace("px",""))-20+"px",opacity:"0"},200,function(){$(this).hide()})}function pb(a,b,c){c&&b&&$(b).text(c),$(a).show().stop().animate({top:"50%",opacity:"1"},200),S().show().stop().animate({opacity:"0.6"},200)}function qb(a){$(a).stop().animate({top:"60%",opacity:"0"},200,function(){$(this).hide()}),S().stop().animate({opacity:"0"},200,function(){$(this).hide()})}function rb(a,b){$(a).css("box-shadow","inset 0px -1px 0px 0px #47bfa1"),$(a).val(b),""!==b?$(a).select():$(a).focus()}function sb(a,b){var i,c=[".mp4",".flv",".wmv",".avi",".3gp",".m4v",".vob",".webm",".qtff",".avchd",".mov",".qt",".swf",".mkv"],d=[".png",".jpg",".jpeg",".tiff",".gif",".exiff"],e=[".wav",".mp3",".aiff",".wma",".m3u",".au",".ogg"],f=[".woff",".ttf",".woff2",".eot",".otf",".svg"],g=[".asp",".aspx",".axd",".asx",".asmx",".ashx",".css",".cfm",".yaws",".swf",".jsp",".jspx",".wss",".do",".action",".js",".json",".pl",".php",".php4",".php3",".phtml",".py",".rb",".rhtml",".shtml",".xml",".rss",".svg",".cgi",".dll"],h=[".md",".html",".htm",".xhtml",".jhtml"],j=Ua(a,".",1);return j="."+j.toLowerCase(),i=b===!0?d.indexOf(j)>-1?'<div class="material-icons">photo</div>':e.indexOf(j)>-1?'<div class="material-icons">volume_up</div>':f.indexOf(j)>-1?'<div class="material-icons">text_format</div>':c.indexOf(j)>-1?'<div class="material-icons">movie</div>':g.indexOf(j)>-1?'<div class="material-icons">code</div>':h.indexOf(j)>-1?'<div class="material-icons">description</div>':'<div class="material-icons">insert_drive_file</div>':d.indexOf(j)>-1?"photo":e.indexOf(j)>-1?"volume_up":f.indexOf(j)>-1?"text_format":c.indexOf(j)>-1?"movie":g.indexOf(j)>-1?"code":h.indexOf(j)>-1?"description":"insert_drive_file"}function tb(a,b){return a.substring(a.lastIndexOf(b),0)}function ub(a){var b=jQuery.grep(h,function(b){var c=tb(b.entry.fullPath,a.name),d=tb(a.fullPath,a.name);return c==d}),c=jQuery.grep(g,function(b){var c=tb(b.entry.fullPath,a.name+"/"),d=tb(a.fullPath,a.name);return c==d});if(console.log(c),0!==b.length)for(var d=0;d<b.length;d++)h.splice(h.lastIndexOf(b[d]),1);if(0!==c.length)for(var e=0;e<c.length;e++)g.splice(g.lastIndexOf(c[e]),1)}function vb(a,b){var c=a.createReader(),d=function(){c.readEntries(function(a){a.length||b();for(var c=0;c<a.length;c++){var e=a[c];e.isDirectory?(h.push({entry:e}),vb(e,b)):g.push({entry:e})}d()})};d()}function wb(a,b,c){$(a).children().each(function(){var a=$(this),d=a.attr("path"),e=d.replace("/"+b+"/","/"+c+"/");if(a.attr("path",e),a.hasClass("file")){var f=F(a),g=zb(f,d);if(v(g)){R(g).attr("path",e);var i=(R(g).attr("path"),bb(f,e,!0,!1));oa(g,i)}}})}function xb(a,b,c,d,e,f,g){a.getFile(b,{},function(b){b.moveTo(a,c,function(a){var b=Ta(a.name),h=sb(a.name,!1),i=sa(a);e.hasClass("active-file")?e.attr("class",b+" file active-file"):e.attr("class",b+" file"),e.attr("path",i),C(e).text(h),G(e,a.name),d.entry=a,f&&g&&(yb(g,c,i),oa(g,a),Gb())},function(a){console.log(a)})},function(a){console.log(a)})}function yb(a,b,c){R(a).find(".title").val(b),R(a).attr("path",c),R(a).attr("data",b+"isOpen")}function zb(a,b){b=sa(b);for(var c=0;c<R().length;c++){var d=R(c).attr("path"),e=R(c).find("input").val();if(d==b&&e==a)return c}}function Ab(a){$(".active .title").val(a)}function Bb(){return $(".active .title").val()}function Cb(a){u().attr("data",a)}function Db(a){a?chrome.fileSystem.getWritableEntry(a,function(a){a.createWriter(function(b){var c=w().getDoc().getValue(),d=new Blob([c]),e=!1;b.onwriteend=function(a){if(!e)return e=!0,void this.truncate(d.size)},b.write(d);var f=a.name;Ab(f),$(".active input").attr("readonly",!0),oa(u().index(),a),void 0!==u().attr("data")&&u().attr("data")!==!1&&""!==u().attr("data")||Cb(f),$(".active .close").text("close"),$(".active .close").removeClass("edit"),u().click(),Fa===!0&&(Ga(m),Fa=!1)})}):console.log("User cancelled saving.")}function Eb(){var a=Bb();chrome.fileSystem.chooseEntry({type:"saveFile",suggestedName:a,acceptsAllTypes:!0},Db)}function Gb(){var b,c,d,a=Bb();if(b=/.+\.([^.]+)$/.exec(a)){var e=CodeMirror.findModeByExtension(b[1]);e&&(c=e.mode,d=e.mime)}else if(/\//.test(a)){var e=CodeMirror.findModeByMIME(a);e&&(c=e.mode,d=a)}else c=d=a;c&&(w().setOption("mode",d),CodeMirror.autoLoadMode(w(),c))}function Hb(){var a=M().width(),b=R().length,c=a/b;c>200&&(c=200),R().css({width:c+"px"})}function Ib(){$(".windowBar").stop().animate({marginTop:"-30px"},200,function(){$(this).hide()}),$(".tabs, .sidebar, .overflow-menu").css({marginTop:"0"}),$(".menu").css("margin-top","15px"),I().css("height","100%"),$(".search-container").is(":visible")?J().css("height","calc(100% - 150px)"):J().css("height","calc(100% - 50px)"),J().css("margin-top","50px")}function Jb(){$(".windowBar").show().stop().animate({marginTop:"0px"},200),$(".tabs, .sidebar, .overflow-menu").css({marginTop:"30px"}),$(".menu").css("margin-top","45px"),I().css("height","calc(100% - 30px)"),$(".search-container").is(":visible")?J().css("height","calc(100% - 180px)"):J().css("height","calc(100% - 80px)"),J().css("margin-top","80px")}function Kb(){$(".started-button").stop().animate({top:"50%",opacity:"1"},400)}function Lb(a,b,d,e,f,g,h,j){z({data:a,tabs:b,state:d,inst:e,actv:f,sideBarWidth:g,projectsize:h,projectamount:j});var k=[];c.forEach(function(a,b){if(""===a||void 0===a);else{var c=chrome.fileSystem.retainEntry(a);k.push({index:b,entry:c})}});var l;l=void 0===Qa||null===Qa?"":chrome.fileSystem.retainEntry(Qa),z({chosenFiles:k,chosenDirs:i,chosenDir:l})}function Mb(a){if(!wa){e=[],d=[],f=[];for(var b=0;b<R().length;b++){var c=b,g=w(c).getValue(),h=C(R(c)).text(),j=i.length,k=c;d[c]=g,e[c]={name:R(c).find(".title").val(),path:R(c).attr("path"),dataAttr:R(c).attr("data"),isReadOnly:R(c).find("input").attr("readonly")},f[c]=h;var l=u().index(),m=I().width();if(k===R().length-1){var o=0;if(0===i.length)Lb(d,e,f,n,l,m,o,j);else for(var p=0;p<i.length;p++)chrome.fileSystem.restoreEntry(i[p],function(a){a.getMetadata(function(a){o+=Math.ceil(a.size),Lb(d,e,f,n,l,m,o,j)})})}}a&&a()}}function Nb(a){I().width(a),M().width($(window).width()-70-a),J().width($(window).width()-a),$(".search-container").width($(window).width()-a)}function Ob(){j={theme:"material",font:"monospace",fontSize:"16px",tabSize:4,softWrap:!0,library:"jquery.min.js",lint:!1,styleActiveLine:!1}}function Pb(a){A({data:"textArray",tabs:"tabArray",state:"editArray",inst:"installed",actv:"activeIndex",sideBarWidth:"sideWidth",projectsize:"projectSize",projectamount:"projectAmount"},function(a){var m,b=a.data,c=a.tabs,d=a.state,e=a.inst,f=a.actv,g=a.sideBarWidth,h=a.projectsize,k=a.projectamount,l=8*JSON.stringify(b).length/1e4;if(m=0===k?Math.ceil(l):Math.ceil(h+l)/k*k/5,Number.isFinite(m)===!1&&(m=1e3),m>15e3&&(m=15e3),m<5e3&&(m=2e3),"textArray"==b||"tabArray"==c||"editArray"==d||"activeIndex"==f||"installed"==e||"sideWidth"==g||"projectSize"==h||"projectAmount"==k)Ob(),Ba(),_(j),Nb(250),setTimeout(function(){Qb(),Hb(),T(),setTimeout(function(){Kb()},200)},1e3);else{e===!0&&$(".getting-started").remove();for(var n=0;n<b.length;n++){za(),x(n,CodeMirror.fromTextArea(document.getElementById("textarea"+Number(B(M().children().last()))),t)),w(n).getDoc().setValue(b[n]),w(n).getDoc().clearHistory(),xa(n),R(n).find(".title").val(c[n].name),R(n).find(".title").attr("readonly",c[n].isReadOnly),R(n).attr("data",c[n].dataAttr),R(n).attr("path",c[n].path),""===R(n).attr("data")&&oa(n,""),"fiber_manual_record"==d[n]&&C(R(n)).addClass("edit"),C(R(n)).text(d[n]);var p=b.length-1;p===n&&(A({chosenFiles:"key",chosenDirs:"rootDirs",chosenDir:"newProjectDir"},function(a){var b=a.chosenFiles,c=a.chosenDirs,d=a.chosenDir;"key"!=b&&b.forEach(function(a,b,c){chrome.fileSystem.isRestorable(a.entry,function(b){chrome.fileSystem.restoreEntry(a.entry,function(b){oa(a.index,b)})})}),"newProjectDir"!=d&&""!==d&&chrome.fileSystem.isRestorable(d,function(a){chrome.fileSystem.restoreEntry(d,function(a){Ra(a)})}),"rootDirs"!=c&&(o=document.createDocumentFragment(),c.forEach(function(a,b,c){chrome.fileSystem.isRestorable(a,function(b){chrome.fileSystem.restoreEntry(a,function(a){i.push(chrome.fileSystem.retainEntry(a)),Aa(a)})})}))}),Nb(g),setTimeout(function(){Qb(),K().append(o.children),Sa(),R(f).click(),ha(),Hb(),W(),y(),T()},m))}}})}function Qb(){if(launchData&&launchData.items)for(var a=0;a<launchData.items.length;a++){var b=[];b.push(launchData.items[a].entry),Na(b,!1)}}function Rb(){chrome.app.window.current().close()}var a=["Please wait...a few bits tried to escape, but we caught them","Please wait...and dream of faster computers","Please wait...would you like fries with that?","Please wait...checking the gravitational constant in your locale","Please wait...go ahead -- hold your breath","Please wait...at least you're not on hold","Please wait...hum something loud while others stare","Please wait...you're not in Kansas any more","Please wait...the server is powered by a lemon and two electrodes","Please wait...we love you just the way you are","Please wait...while a larger software vendor in Seattle takes over the world","Please wait...we're testing your patience","Please wait...as if you had any other choice","Please wait...take a moment to sign up for our lovely prizes","Please wait...don't think of purple hippos","Please wait...follow the white rabbit","Please wait...why don't you order a sandwich?","Please wait...programming the flux capacitor","Please wait...the bits are breeding"];$(".loading-text").text(a[Math.round(Math.random()*(a.length-1))]),$(".windowBar").initializeWindowBar("#000000"),Pb(launchData),$(".menu, .dropdown, .settings-container, .bg, .dialogue, .search-container, .contextmenu, .folder-contextmenu, .remove-dialogue, .folder-remove-dialogue, .new-file-dialogue, .new-folder-dialogue, .new-project-dialogue, .rename-folder-dialogue, .rename-file-dialogue, .settingdiv span").hide();var j,k,l,m,n,o,p,q,r,s,b=[],c=[],d=[],e=[],f=[],g=[],h=[],i=[],t={lineNumbers:!0,lineWrapping:!0,styleActiveLine:!1,matchBrackets:!0,autoCloseTags:!0,autoCloseBrackets:!0,viewportMargin:10,historyEventDelay:400,tabSize:4,indentUnit:4,foldGutter:!0,dragDrop:!1,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],lint:!1,theme:"material",mode:"text/plain"};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$(document).on("click",".selector-container",function(){var a=$(this).attr("class").split(" ");a=a[a.length-1];var b=a.replace("selector-","");b=$(".dropdown-"+b),U(b);var c=C($(this));"arrow_drop_down"==c.text()?c.text("arrow_drop_up"):c.text("arrow_drop_down")}),$(".settings").scroll(function(){var a=$(this).scrollTop();0!==a?$(".top-title").css("box-shadow","0px 5px 9px 0px rgba(0,0,0,0.1)"):$(".top-title").css("box-shadow","none")}),$(document).on("click",".activeline-checkbox",function(){$(this).hasClass("active-checkbox")?(fa(!1,".activeline-checkbox"),ja(!1,{option:"styleActiveLine",value:!1})):(fa(!0,".activeline-checkbox"),ja(!1,{option:"styleActiveLine",value:!0})),V()}),$(document).on("click",".linter-checkbox",function(){$(this).hasClass("active-checkbox")?(fa(!1,".linter-checkbox"),ja(!1,{option:"lint",value:!1})):(fa(!0,".linter-checkbox"),ja(!1,{option:"lint",value:!0})),V()}),$(document).on("click",".dropdown .theme",function(){var a="theme",b=$(this).text().replace(/ /g,"-");u().attr("class","tab active active-"+b),ka($(".selector-theme"),$(this).text()),ja(!1,{option:a,value:b}),na(a,b),Y(ma()),la(ma()),U($(this).parent()),V()}),$(document).on("click",".dropdown .font-fam",function(){var a=$(this).text().capitalizeFirstLetter();ka($(".selector-font"),$(this).text()),H().css("font-family",a),W(),U($(this).parent()),V()}),$(document).on("click",".dropdown .font-size",function(){var a=$(this).text();ka($(".selector-font-size"),a),H().css("font-size",a),W(),U($(this).parent()),V()}),$(document).on("click",".dropdown .tab-size",function(){var a=Number($(this).text());ka($(".selector-tab-size"),a),ja(!1,{option:"tabSize",value:a}),na("tabSize",a),na("indentUnit",a),W(),U($(this).parent()),V()}),$(document).on("click",".dropdown .wrap",function(){var a=$(this).text();a="none"!=a,ka($(".selector-wrap"),$(this).text()),ja(!1,{option:"lineWrapping",value:a}),na("lineWrapping",a),W(),U($(this).parent()),V()}),$(document).on("click",".dropdown .library",function(){var b,a=$(this).text();b=nb?"keyboard_arrow_down"==C(nb).first().text()||"book"==C(nb).eq(1).text()?nb:nb.parent().parent():K().children().first();var c=[];if(U($(this).parent()),b&&0!==K().children().length)if(b.children().last().children().each(function(){if($(this).hasClass("file")){var a=F($(this));c.push(a)}}),navigator.onLine)if(c.indexOf(a)>-1)$(".settingdiv span").text(a+" already exists."),$(".settingdiv span").show();else{switch(ka($(".selector-library"),a),a){case"jquery.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js",a);break;case"matter.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.10.0/matter.min.js",a);break;case"p5.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.7/p5.min.js",a);break;case"angular.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js",a);break;case"backbone.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js",a);break;case"ember.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/ember.js/2.11.2/ember.min.js",a);break;case"react.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.min.js",a);break;case"react-dom.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.min.js",a);break;case"three.min.js":ta("https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js",a)}$(".settingdiv span").hide()}else $(".settingdiv span").show();else $(".settingdiv span").text("No folder selected. Click on the folder you wish to add "+a+" to in the projects section."),$(".settingdiv span").show()}),$(".close-settings").click(function(){va(),y()}),S().click(function(){$(".dialogue").is(":visible")&&Ea(),$(".dialog").is(":visible")&&qb(".dialog"),L().is(":visible")&&va(),y()}),$(".settings-button").click(function(){ua()}),$(document).on("click",".CodeMirror",function(a){""===$(".active .title").val()&&$(".active .title").val("untitled.txt"),La()}),Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);this.splice(b,0,this.splice(a,1)[0])};var wa;M().sortable({axis:"x",distance:20,tolerance:"pointer",revert:!0,start:function(a,b){a.stopImmediatePropagation(),a.stopPropagation(),wa=!0,$(this).attr("data-previndex",b.item.index()),$(this).addClass("noclick")},stop:function(a,d){a.stopImmediatePropagation(),a.stopPropagation(),wa=!1;var e=d.item.index(),f=$(this).attr("data-previndex"),g=B(d.item),h=$(".workspace > textarea").eq(e).attr("id").replace("textarea","");$(this).removeAttr("data-previndex"),f>e?($("#textarea"+g).insertBefore($("#textarea"+h)),H().eq(f).insertBefore($("#textarea"+h))):(H().eq(f).insertAfter(H().eq(e)),$("#textarea"+g).insertBefore(H().eq(e))),qa(b,f,e),qa(c,f,e),y()}}).disableSelection(),$(document).on("click",".tab",function(a){if(a.stopPropagation(),$(this).hasClass("noclick"))$(this).removeClass("noClick");else{var b,c,d,e,f=$(this);0===f.find(".ink").length&&f.prepend('<div class="ink"></div>'),b=f.find(".ink"),b.removeClass("animate"),b.height()||b.width()||(c=Math.max(f.width(),f.height()),b.css({height:c,width:c})),d=a.pageX-f.offset().left-b.width()/2,e=a.pageY-f.offset().top-b.height()/2,b.css({top:e+"px",left:d+"px"}).addClass("animate"),R().removeClass("active"),R().removeClass("active-"+t.theme),$(this).addClass("active"),$(this).addClass("active-"+t.theme),H().hide(),H().eq(u().index()).show(),Gb(),l=pa($(this).index()),ea($('.file[path="'+$(this).attr("path")+'"]')),w().refresh(),y()}});var Ca;$(document).on("mouseenter",".tab input",function(){var a=$(this),b=a.parent(),c=b.attr("path"),d=$(this).val();if(void 0===c);else{var e=bb(d,c,!0,!1,!1);void 0===e?(e=bb(d,c,!1,!1,!0,!0),void 0===e||chrome.fileSystem.getDisplayPath(e,function(a){c=a})):chrome.fileSystem.getDisplayPath(e,function(a){c=a})}Ca=setTimeout(function(){void 0===b.attr("path")||($(".tooltip").text(c),$(".tooltip").css({top:a.offset().top+a.height()-20,left:a.offset().left,backgroundColor:X(u().css("box-shadow").replace(/^.*(rgba?\([^)]+\)).*$/,"$1"),.1)}),$(".tooltip").show().animate({top:Number($(".tooltip").css("top").replace("px",""))+25,opacity:"1"},200))},2e3)}),$(document).on("mouseleave",".tab",function(){clearTimeout(Ca),$(".tooltip").animate({top:Number($(".tooltip").css("top").replace("px",""))-25,opacity:"0"},200,function(){$(this).hide()})}),$(".buttons-dialogue .cancel").click(function(){Ea(),y()}),$(".buttons-dialogue .no").click(function(){Ga(m),Ea()});var Fa;$(".buttons-dialogue .yes").click(function(){Fa=!0,$(".save").click(),Ea()}),$(document).on("click",".close",function(a){a.stopImmediatePropagation(),a.stopPropagation(),"fiber_manual_record"==$(this).text()?Da($(this)):Ga($(this))}),$(document).on("change",".title",function(a){Gb()}),$(document).on("keyup",".title",function(a){13==a.keyCode&&(""===$(this).val()&&$(this).val("untitled.txt"),y())}),$(document).on("keydown",".title",function(a){65==a.keyCode&&a.ctrlKey&&a.target.select(),9==a.keyCode&&""===$(this).val()&&$(this).val("untitled.txt")}),$(".search-bar").keyup(function(){$(this).css("box-shadow","inset 0px -1px 0px 0px rgba(0, 0, 0, 0.2)")}),$(".search-bar").focus(function(){$(this).css("box-shadow","inset 0px -1px 0px 0px rgba(0, 0, 0, 0.2)")}),$(".find_next").click(function(){p=$(".search-bar").val(),r=w(),s=getSearchState(r),Ja("true"),startSearch(r,s,p),doSearch(r,!1)}),$(".find_prev").click(function(){p=$(".search-bar").val(),r=w(),s=getSearchState(r),Ja("true"),startSearch(r,s,p),doSearch(r,!0)}),$(".replace_all").click(function(){p=$(".search-bar").val(),q=$(".search-replace").val(),r=w(),Ja("true"),replaceAll(r,p,q)}),$(".replace").click(function(){q=$(".search-bar").val(),p=$(".search-replace").val(),r=w();var a=getSearchCursor(r,q,r.getCursor("from"));Ja("true");var b=function(){var c,b=a.from();if((c=a.findNext())||(a=getSearchCursor(r,q),(c=a.findNext())&&(!b||a.from().line!=b.line||a.from().ch!=b.ch))){r.setSelection(a.from(),a.to()),r.scrollIntoView({from:a.from(),to:a.to()});var d=function(b){a.replace("string"==typeof q?p:p.replace(/\$(\d)/g,function(a,c){return b[c]}))};d(c)}};b()}),$(document).bind("keydown",function(a){(a.ctrlKey&&83==a.keyCode&&!a.shiftKey||a.metaKey&&83==a.keyCode&&!a.shiftKey)&&$(".save").click(),(a.ctrlKey&&a.shiftKey&&83==a.keyCode||a.metaKey&&a.shiftKey&&83==a.keyCode)&&$(".save-as").click(),(a.ctrlKey&&78==a.keyCode||a.metaKey&&78==a.keyCode)&&(a.preventDefault(),N().click()),(a.ctrlKey&&79==a.keyCode||a.metaKey&&79==a.keyCode)&&O().click(),(a.ctrlKey&&80==a.keyCode||a.metaKey&&80==a.keyCode)&&(L().is(":visible")?va():ua()),(a.ctrlKey&&70==a.keyCode||a.metaKey&&70==a.keyCode)&&($(".search-container").is(":visible")&&""===window.getSelection()?Ia():Ha()),(a.ctrlKey&&87==a.keyCode||a.metaKey&&87==a.keyCode)&&(a.preventDefault(),$(".active .close").click()),27==a.keyCode&&(chrome.app.window.current().isFullscreen()?(a.preventDefault(),$(".search-container").is(":visible")&&Ia()):$(".search-container").is(":visible")&&Ia()),a.ctrlKey&&191==a.keyCode&&(a.preventDefault(),Nb(0===I().width()?250:0),Hb()),a.ctrlKey&&187==a.keyCode&&(36==Number(H().css("font-size").replace("px",""))||$(".font-size").eq($(".font-size:contains("+H().css("font-size")+")").index()+1).click()),
a.ctrlKey&&189==a.keyCode&&(12==Number(H().css("font-size").replace("px",""))||$(".font-size").eq($(".font-size:contains("+H().css("font-size")+")").index()-1).click()),a.altKey&&81==a.keyCode&&("wrap"==$(".selector-wrap").clone().children().remove().end().text()?$(".wrap:contains(none)").click():$(".wrap:contains(wrap)").click())}),$(".overflow-menu").click(function(){Ka()}),$(".menu-li").click(function(){La()}),$(document).on("click",".workspace, .tab, .tabs, .sidebar",function(){La()}),$(document).on("click",".title",function(a){a.stopImmediatePropagation(),a.stopPropagation(),"readonly"==$(this).attr("readonly")&&(a.preventDefault(),$(this).parent().click()),La()}),N().click(function(){za();var a=u().index();b[a]=CodeMirror.fromTextArea(document.getElementById("textarea"+Number(M().children().last().attr("id").replace("tab",""))),t),void 0===j&&Ob(),_(j),setTimeout(function(){b[a].focus(),xa(a)},1)}),O().click(function(){chrome.fileSystem.chooseEntry({acceptsMultiple:!0},function(a){a||console.log("No Files Selected"),Na(a,!1)})}),I().resizable({handles:"e",maxWidth:600,resize:function(a,b){var c=b.size.width;M().width($(window).width()-70-c),J().width($(window).width()-c),$(".search-container").width($(window).width()-c),Hb()}}),Q().click(function(){Oa(),rb(".new-project-input","")}),$(".new-project-cancel").click(function(){Pa(),y()});var Qa;K().scroll(function(){eb(),gb()}),$(".chooseDir").click(function(){chrome.fileSystem.chooseEntry({type:"openDirectory"},function(a){if(a)Ra(a),$(".new-project-input").focus();else{var b="No Directory Chosen";Ra(b)}})}),$(".new-project-create").click(function(){var a=$(this).parent().parent().find("input").val();""===a&&(a="untitled"),Qa.getDirectory(a,{create:!0,exclusive:!0},function(a){i.push(chrome.fileSystem.retainEntry(a)),h.push({entry:a});var b=sa(a),c=document.createElement("div"),d=a.name;d=Ta(d),c.className=d+" folder",c.setAttribute("path",b),c.innerHTML='<div class="material-icons">keyboard_arrow_right</div><div class="material-icons">book</div><label class="folder-name">'+a.name+'</label><ul class="'+d+'ul"></ul>',K().append(c),K().children().last().children().last().hide(),Pa(),y()})}),$(".dialog-input:not(.rename-file-input, .rename-folder-input)").keyup(function(a){var b=$(this).val();""===b&&(b="untitled");var c=[];$(this).hasClass("new-project-input")?(K().children().each(function(a){c.push(D($(this)))}),13==a.keyCode&&$(".new-project-create").click()):nb.children().last().children().each(function(a){c.push(D($(this)))}),c.indexOf(b)>-1?$(this).css("box-shadow","inset 0px -1px 0px 0px #d61f1f "):$(this).css("box-shadow","inset 0px -1px 0px 0px #47bfa1")}),o=document.createDocumentFragment(),P().click(function(){chrome.fileSystem.chooseEntry({type:"openDirectory"},function(a){if(a){var b;if(0===i.length)o.innerHTML="",i.push(chrome.fileSystem.retainEntry(a)),Ya(a.name,_a,a);else for(var c=0;c<i.length;c++)chrome.fileSystem.restoreEntry(i[c],function(c){c.fullPath==a.fullPath&&(b=!0)}),c===i.length-1&&(b===!0||(i.push(chrome.fileSystem.retainEntry(a)),Ya(a.name),o.innerHTML="",a.getMetadata(function(b){var c=b.size,d=Math.ceil(c);Number.isFinite(d)===!1&&(d=1e3),d>2e4&&(d=2e4),d<5e3&&(d=2500),Aa(a),setTimeout(function(){K().append(o.children),Sa(),Za()},d)})))}else console.log("No Directory Selected")})}),$(document).on("click",".projects .folder",function(a){a.stopPropagation(),ea($(this)),$(this).children("ul").is(":visible")?($(this).children("ul").hide(),$(this).children(".material-icons").first().text("keyboard_arrow_right")):($(this).children("ul").children().each(function(a){ab($(this))}),$(this).children("ul").show(),$(this).children(".material-icons").first().text("keyboard_arrow_down")),nb=$(this)}),$(document).on("click",".projects ul",function(a){a.stopPropagation(),a.stopImmediatePropagation()});var cb;$(document).on("click",".projects .file",function(a){if(a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation(),a.handled!==!0){a.handled=!0,ea($(this));var b=[],c=F($(this)),d=$(this).attr("path"),e=bb(c,d,!0,!1),f=zb(c,d);v(f)?R(f).click():(b.push(e),Na(b,!0)),jb=$(this)}eb()});var hb,ib,jb,kb,lb,mb,nb,ob;$(document).on("contextmenu",".projects .file",function(a){a.stopPropagation(),a.preventDefault(),kb=F($(this)),hb=kb,ib=$(this).attr("path"),jb=$(this),ea($(this)),db(a)}),$(".folder-contextmenu .folder-rename").click(function(){pb(".rename-folder-dialogue"),eb(),rb(".rename-folder-input",lb)}),$(".rename-folder-cancel").click(function(){qb(".rename-folder-dialogue"),y()}),$(".rename-folder-create").click(function(){var a=$(".rename-folder-input").val();""===a&&(a=lb);var b=[];if(nb.parent().children().each(function(a){var c=D($(this));c==lb||b.push(c)}),b.indexOf(a)>-1)$(".rename-folder-input").css("box-shadow","inset 0px -1px 0px 0px #d61f1f"),$(".rename-folder-input").focus();else{var c=function(a){var b=sa(a.entry);return a.entry.name==lb&&b==mb},d=bb(lb,mb,!1,!0),e=h.findIndex(c);d.getParent(function(b){d.moveTo(b,a,function(b){var c=b.name;c=Ta(c);var f=sa(b);da(),nb.attr("class",c+" folder active-folder"),nb.attr("path",f),nb.children().last().attr("class",c+"ul"),E(nb,a),ub(d),vb(b,function(){wb("."+c+"ul",d.name,b.name)}),h[e]={entry:b},qb(".rename-folder-dialogue"),y()})})}}),$(".contextmenu .rename").click(function(){pb(".rename-file-dialogue"),eb(),rb(".rename-file-input",hb)}),$(".rename-file-create").click(function(){var a=$(this).parent().parent().find("input").val(),b=bb(hb,ib,!0,!1);b=b.name,""===a&&(a=b);var c=[];if(jb.parent().children().each(function(a){var d=F($(this));d==b||c.push(d)}),c.indexOf(a)>-1)$(this).parent().parent().find("input").css("box-shadow","inset 0px -1px 0px 0px #d61f1f "),$(".rename-file-input").focus();else{var d=Ua(ib,"/",2),e=ib.split("/");e.splice(e.length-1,1),e=e.join("/");var f=bb(d,e,!1,!0),g=bb(hb,ib,!0,!1,!0),h=zb(hb,g.entry.fullPath);v(h)?xb(f,g.entry.name,a,g,jb,!0,h):xb(f,g.entry.name,a,g,jb,!1),qb(".rename-file-dialogue"),y()}}),$(".rename-file-cancel").click(function(){qb(".rename-file-dialogue"),y()}),$(".contextmenu .remove").click(function(){var a="Are you sure you want to remove "+kb+"? This action cannot be undone.";pb(".remove-dialogue",".remove-dialogue-text",a),eb()}),$(document).on("contextmenu",".projects .folder",function(a){a.stopPropagation(),a.preventDefault(),ob=D($(this)),lb=ob,mb=$(this).attr("path"),nb=$(this),fb(a),ea($(this));var b=K().children(),c=[];b.each(function(){c.push($(this).attr("path"))}),c.indexOf(mb)>-1?($(".folder-contextmenu .folder-rename").hide(),$(".folder-contextmenu .folder-removefromproject").show()):($(".folder-contextmenu .folder-rename").show(),$(".folder-contextmenu .folder-removefromproject").hide())}),$(document).on("keyup",".new-folder-dialogue input",function(a){a.stopPropagation(),13==a.keyCode&&$(".new-folder-create").click()}),$(document).on("keyup",".new-file-dialogue input",function(a){a.stopPropagation(),13==a.keyCode&&$(".new-file-create").click()}),$(document).on("keyup",".rename-file-input",function(a){a.stopPropagation();var b=$(this).val(),c=bb(hb,ib,!0,!1).name;""===b&&(b=c);var d=[];jb.parent().children().each(function(a){var b=F($(this));b==c||d.push(b)}),d.indexOf(b)>-1?$(this).css("box-shadow","inset 0px -1px 0px 0px #d61f1f "):$(this).css("box-shadow","inset 0px -1px 0px 0px #47bfa1"),13==a.keyCode&&$(".rename-file-create").click()}),$(document).on("keyup",".rename-folder-input",function(a){a.stopPropagation();var b=$(this).val(),c=bb(lb,mb,!1,!0).name;""===b&&(b=c||"untitled");var d=[];nb.parent().children().each(function(a){var b=D($(this));b==c||d.push(b)}),d.indexOf(b)>-1?$(this).css("box-shadow","inset 0px -1px 0px 0px #d61f1f "):$(this).css("box-shadow","inset 0px -1px 0px 0px #47bfa1"),13==a.keyCode&&$(".rename-folder-create").click()}),$(".folder-contextmenu .folder-removefromproject").click(function(){var a=bb(lb,mb,!1,!0);ub(a);for(var b,c=0;c<i.length;c++)chrome.fileSystem.restoreEntry(i[c],function(d){d.fullPath==a.fullPath&&(i.splice(c,1),b=!0)});b&&(nb.velocity("slideUp",{duration:200,complete:function(){$(this).remove()}}),y())}),$(".folder-contextmenu .folder-addfolder").click(function(){pb(".new-folder-dialogue"),gb(),rb(".new-folder-input","")}),$(".new-folder-create").click(function(){var a=$(this).parent().parent().find("input").val();""===a&&(a="untitled");var b=[];if(nb.children().last().children().each(function(a){b.push(D($(this)))}),b.indexOf(a)>-1)$(".new-folder-input").css("box-shadow","inset 0px -1px 0px 0px #d61f1f "),$(".new-folder-input").focus();else{var c=bb(lb,mb,!1,!0);c.getDirectory(a,{create:!0,exclusive:!0},function(a){h.push({entry:a});var b=a.name;b=Ta(b);var c=document.createElement("div"),d=sa(a);c.className=b+" folder active-folder",c.setAttribute("path",d),c.innerHTML='<div class="material-icons">keyboard_arrow_right</div><div class="material-icons">folder</div><label class="folder-name">'+a.name+'</label><ul class="'+b+'ul"></ul>',"keyboard_arrow_right"==C(nb).first().text()&&nb.click(),da(),nb.children().last().append(c),nb.children().last().children().last().children().last().hide(),nb.children().last().children().last().insertBefore(nb.children().last().children().first()),ab(nb.children().last().children().first()),qb(".new-folder-dialogue")})}}),$(".new-folder-cancel").click(function(){qb(".new-folder-dialogue"),y()}),$(".folder-contextmenu .folder-remove").click(function(){var a="Are you sure you want to remove "+ob+"? This will PERMANENTLY delete this folder from your computer.";pb(".folder-remove-dialogue",".folder-remove-dialogue-text",a),gb()}),$(".folder-remove-yes").click(function(){var a=bb(ob,mb,!1,!0);a.removeRecursively(function(){R().each(function(b){if(void 0===$(this).attr("path"));else{var c=sa(a.fullPath);$(this).attr("path").indexOf(c)>-1&&Ga($(this).find(".close"),!0)}}),1==u().length||R(Math.round(Math.random()*(R().length-1))).click();for(var b=0;b<i.length;b++)chrome.fileSystem.restoreEntry(i[b],function(c){a.fullPath==c.fullPath&&i.splice(b,1)});0===$(".tab").length&&N().click(),Hb(),nb.remove(),qb(".folder-remove-dialogue"),y()})}),$(".folder-remove-no").click(function(){qb(".folder-remove-dialogue"),y()}),$(".folder-addfile").click(function(){pb(".new-file-dialogue"),eb(),rb(".new-file-input","")}),$(".new-file-cancel").click(function(){qb(".new-file-dialogue"),y()}),$(".new-file-create").click(function(){var a=$(this).parent().parent().find("input").val();""===a&&(a="untitled.txt");var b=[];if(nb.children().last().children().each(function(a){b.push(F($(this)))}),b.indexOf(a)>-1)$(".new-file-input").css("box-shadow","inset 0px -1px 0px 0px #d61f1f"),$(".new-file-input").focus();else{console.log(lb,mb),console.log(h);var c=bb(lb,mb,!1,!0);c.getFile(a,{create:!0,exclusive:!0},function(a){var b=[];b.push(a),Na(b,!0),g.push({entry:a});var c=a.name;c=Ta(c),l=a;var d=document.createElement("div"),e=sb(a.name,!0),f=sa(a);d.className=c+" file active-file",d.setAttribute("path",f),d.innerHTML=e+'<label class="file-name">'+a.name+"</label>","keyboard_arrow_right"==C(nb).first().text()&&nb.click(),da(),nb.children().last().append(d),ab(nb.children().last().children().last()),qb(".new-file-dialogue")})}}),$(".remove-buttons .remove-yes").click(function(){cb=bb(hb,ib,!0,!1);var a=zb(hb,cb.fullPath);v(a)?(Ga(R(a).find(".close")),cb.remove(function(){jb.remove(),qb(".remove-dialogue"),y()})):cb.remove(function(){jb.remove(),qb(".remove-dialogue"),y()})}),$(".remove-buttons .remove-no").click(function(){qb(".remove-dialogue"),y()}),$(document).on("mousedown",function(a){var b=a.target;$(b).parents().is(".contextmenu")&&$(b).parents().is(".folder-contextmenu")||(eb(),gb(),clearTimeout(Ca),$(".tooltip").animate({top:Number($(".tooltip").css("top").replace("px",""))-25,opacity:"0"},200,function(){$(this).hide()}))}),$(".save").click(function(){if(l=pa(u().index()))Db(l);else{var a=Bb();chrome.fileSystem.chooseEntry({type:"saveFile",suggestedName:a,acceptsAllTypes:!0},Db)}}),$(".save-as").click(function(){Eb()}),$(".tidy-up").click(function(){var b,a=w().getValue();b=$(".active .title").val().indexOf(".html")>-1?html_beautify(a,{indent_size:t.tabSize}):$(".active .title").val().indexOf(".css")>-1?css_beautify(a,{indent_size:t.tabSize}):$(".active .title").val().indexOf(".js")>-1?js_beautify(a,{indent_size:t.tabSize}):js_beautify(a,{indent_size:t.tabSize}),w().setValue(b)});new DnDFileController("body",function(a){for(var b=[],c=0;c<a.items.length;c++)b.push(a.items[c].webkitGetAsEntry()),c===a.items.length-1&&Na(b,!1)});$(window).resize(function(){var a=I().width();Nb(a),Hb(),chrome.app.window.current().isFullscreen()?Ib():Jb()}),$(".started-button").click(function(){$(".getting-started").stop().animate({top:"-100%",opacity:"0"},400,function(){$(this).remove()}),n=!0,Mb(),y()}),chrome.runtime.onMessage.addListener(function(a,b,c){a.open&&Qb()}),$(document).delegate(".app-windowbar-close","click",function(){Mb(Rb)}),$(window).mouseleave(function(){Mb()}),$(document).delegate(".app-windowbar-minimize","click",function(){chrome.app.window.current().minimize()}),$(document).delegate(".app-windowbar-maximize","click",function(){y(),chrome.app.window.current().isMaximized()?chrome.app.window.current().restore():chrome.app.window.current().maximize()})});